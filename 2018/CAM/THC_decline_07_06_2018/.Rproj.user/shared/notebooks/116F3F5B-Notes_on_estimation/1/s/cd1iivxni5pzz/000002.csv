"0","library( utilityf )"
"0","ed_model = function( param, x, log = F ) {"
"0","  # Purpose:"
"0","  # Computes the predicted THCCOOH values "
"0","  # using an exponential decay model."
"0","  # Arguments:"
"0","  # param - A vector with the starting level of "
"0","  #         THCCOOH and the elimation rate"
"0","  # x     - A vector with the days since THC "
"0","  #         ingestion"
"0","  # log   - Logical; if TRUE, returns the "
"0","  #         log THCCOOH values instead"
"0","  # Returns:"
"0","  # The predicted log THCCOOH levels per each day."
"0","  "
"0","  yhat = log( param[1] ) - param[2] * x"
"0","  if ( !log ) yhat = exp( yhat )"
"0","  "
"0","  return( yhat )"
"0","}"
"0","# Generating parameters"
"0","gp = c("
"0","  alpha = 100,"
"0","  kappa = .25,"
"0","  sigma = 1"
"0",")"
"0","# Simulate data"
"0","sim_dat = data.frame("
"0","  Time = seq( 0, 34, length = 100 ),"
"0","  epsilon = NA, "
"0","  log_THCCOOH = NA,"
"0","  THCCOOH.obs = NA,"
"0","  log_THCCOOH.obs = NA"
"0",")"
"0","set.seed( 393 )"
"0","sim_dat$epsilon = rnorm( nrow(sim_dat), 0, gp[3] )"
"0","sim_dat$log_THCCOOH = ed_model( gp, sim_dat$Time, log = T )"
"0","sim_dat$log_THCCOOH.obs = sim_dat$log_THCCOOH + sim_dat$epsilon"
"0","sim_dat$THCCOOH.obs = exp( sim_dat$log_THCCOOH.obs )"
"0","cut_off = 1"
"0","xl = c( -1, 35 )"
"0","yl = lowerUpper( 1, sim_dat$log_THCCOOH.obs )"
"0","blankPlot( xl, yl )"
